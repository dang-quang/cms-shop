_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[158],{"6t8x":function(e,t,r){"use strict";r.r(t);var n=r("nKUr"),a=r("o0o1"),c=r.n(a),o=r("HaE+"),s=r("ODXe"),u=r("q1tI"),i=r.n(u),p=r("WIEF"),d=r("sp93"),l=r("s/Ec"),b=r("lsQ0"),h=r("oxre"),f=r("9kay"),j=r("/MKj"),v=r("DzNn"),O=r("20a2"),m=r("bgFo"),x=r("LvDl"),_=r("Orb1"),g=r("No4j"),S=r("WztA"),C=r("LWFf"),E=r("jA42");t.default=function(){var e=143,t=Object(O.useRouter)(),r=Object(j.useDispatch)(),a=Object(f.c)().t,u=Object(j.useSelector)((function(e){return e.app})),w=u.loading,y=u.showLoader,k=w||y,R=i.a.useState([]),P=Object(s.a)(R,2),N=P[0],M=P[1],U=i.a.useState(null),V=Object(s.a)(U,2),D=V[0],A=V[1],H=Object(p.d)(!1),T=Object(s.a)(H,2),G=T[0],W=T[1],I=W.on,L=W.off,z=i.a.useState(1),F=Object(s.a)(z,2),X=(F[0],F[1]),q=i.a.useState(0),J=Object(s.a)(q,2),K=J[0],B=J[1],Q=Object(j.useSelector)((function(e){return e.voucher})),Y=Q.doSearchVoucher,Z=Q.searchVoucherName,$=[a("voucher.voucher_name_code"),a("voucher.voucher_type"),a("voucher.discount_amount"),a("voucher.usage_quantity"),a("voucher.usage"),a("voucher.status_claiming_period"),a("voucher.actions")],ee=Object(h.usePagination)({total:K,limits:{outer:1,inner:2},initialState:{pageSize:50,isDisabled:!1,currentPage:1}}),te=ee.pages,re=ee.pagesCount,ne=ee.currentPage,ae=ee.setCurrentPage,ce=ee.isDisabled;i.a.useEffect((function(){Object(o.a)(c.a.mark((function t(){var n,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r(Object(v.v)(!0)),n={shopId:e,page:1,type:_.n.UPCOMING},Z&&(n.keyWord=Z),t.next=6,Object(g.j)(n);case 6:(o=t.sent).code===_.b.MSG_SUCCESS&&o.data&&o.data.results?(M(o.data.results),X(o.data.totalPages),B(o.data.totalRecords)):S.b.error({title:a("error"),message:a("no_data_exists")});case 8:return t.prev=8,r(Object(v.v)(!1)),t.finish(8);case 11:case"end":return t.stop()}}),t,null,[[0,,8,11]])})))()}),[Z]),i.a.useEffect((function(){Object(o.a)(c.a.mark((function t(){var n,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n={id:e,page:ne,type:_.n.UPCOMING},!Y){t.next=10;break}return r(Object(v.v)(!0)),r(Object(v.o)(!0)),Z&&(n.keyWord=Z),t.next=8,Object(g.j)(n);case 8:(o=t.sent).code===_.b.MSG_SUCCESS&&o.data&&o.data.results?(M(o.data.results),X(o.data.totalPages),B(o.data.totalRecords)):(M([]),X(1),B(0),S.b.error({title:a("no_results_found"),message:a("no_results_found_for_your_search")}));case 10:return t.prev=10,r(Object(C.d)(!1)),r(Object(v.v)(!1)),setTimeout((function(){r(Object(v.o)(!1))}),2e3),t.finish(10);case 15:case"end":return t.stop()}}),t,null,[[0,,10,15]])})))()}),[e,Y,ne,Z]);var oe=i.a.useCallback(Object(o.a)(c.a.mark((function t(){var n,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={id:e,page:1,type:_.n.UPCOMING},Z&&(n.keyWord=Z),t.next=4,Object(g.j)(n);case 4:(o=t.sent).code===_.b.MSG_SUCCESS&&o.data&&o.data.results?(M(o.data.results),X(o.data.totalPages),B(o.data.totalRecords),r(Object(v.p)(0))):(M([]),X(1),B(0),S.b.error({title:a("error"),message:a("no_data_exists")}));case 6:case"end":return t.stop()}}),t)}))),[e,ne,Z]),se=i.a.useCallback(Object(o.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,L(),r(Object(v.v)(!0)),e.next=5,Object(g.d)({id:D.id});case 5:(t=e.sent).code===_.b.MSG_SUCCESS?(A(null),oe()):S.b.error({title:a("error"),message:t.message?t.message.text:a("error")}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("delete voucher shop error",e.t0);case 12:return e.prev=12,r(Object(v.v)(!1)),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])}))),[D]);return Object(n.jsxs)(d.d,{children:[Object(n.jsx)(d.d,{mt:"6",position:"relative",bg:"white",minH:Object(x.isEmpty)(N)||k?"300px":"unset",borderRadius:"4px",overflow:"auto",borderWidth:"1px",borderColor:"border-5",children:Object(n.jsxs)(l.a,{variant:"simple",minW:"1200px",children:[Object(n.jsx)(l.h,{h:"52px",bg:"primary.100",children:Object(n.jsx)(l.i,{children:$.map((function(e,t){return Object(n.jsx)(l.g,{borderBottomWidth:"0px",color:"white",textStyle:"b-md",textTransform:"capitalize",isNumeric:2===t||3===t||t===$.length-1,children:e},t)}))})}),k?Object(n.jsx)(m.i,{}):Object(x.isEmpty)(N)?Object(n.jsx)(m.b,{title:a("no_voucher_found"),children:Object(n.jsx)(b.a,{as:E.h,w:"92px",h:"86px"})}):Object(n.jsx)(n.Fragment,{children:N.map((function(e,r){return Object(n.jsx)(m.x,{item:e,index:r,onUpdate:function(){t.push({pathname:"/shop/voucher-coupon/update",query:e})},onDelete:function(){A(e),I()}},r)}))})]})}),!Object(x.isEmpty)(N)&&!k&&Object(n.jsxs)(d.j,{justifyContent:"space-between",alignItems:"center",children:[Object(n.jsx)(m.m,{pagesCount:re,currentPage:ne,isDisabled:ce,onPageChange:function(e){M([]),ae(e)},pages:te,mt:"24px",mb:"8px"}),Object(n.jsx)(d.C,{textStyle:"h4-m",children:a("results_page",{start:50*(ne-1)+1,end:50*(ne-1)+N.length,total:K})})]}),Object(n.jsx)(m.j,{isOpen:G,onClose:L,title:a("voucher.delete_voucher"),description:a("voucher.description_delete_voucher"),buttonLeft:{title:a("cancel"),onClick:L},buttonRight:{title:a("delete"),onClick:se}})]})}},LWFf:function(e,t,r){"use strict";r.d(t,"h",(function(){return h})),r.d(t,"g",(function(){return f})),r.d(t,"f",(function(){return j})),r.d(t,"e",(function(){return v})),r.d(t,"d",(function(){return O})),r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return x})),r.d(t,"c",(function(){return _}));var n=r("o0o1"),a=r.n(n),c=r("HaE+"),o=r("Orb1"),s=r("LvDl"),u=r.n(s),i=r("20a2"),p=r.n(i),d=r("WztA"),l=r("CXox"),b=r("DzNn");function h(e){return{type:o.a.SELECTED_VOUCHERS,selectedVouchers:e}}function f(e){return{type:o.a.SEARCH_VOUCHER_NAME,searchVoucherName:e}}function j(e){return{type:o.a.SEARCH_PROGRAM_VOUCHER_NAME,searchProgramVoucherName:e}}function v(e){return{type:o.a.SEARCH_PROGRAM_VOUCHER_DATE,searchProgramVoucherDate:e}}function O(e){return{type:o.a.DO_SEARCH_VOUCHER,doSearchVoucher:e}}var m=function(){return function(){var e=Object(c.a)(a.a.mark((function e(t,r){var n,c,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=r().voucher.selectedVouchers,c=u.a.flatMap(n,"vouchers").map((function(e){return e.id})),t(Object(b.v)(!0)),!c.length){e.next=14;break}return e.next=7,Object(l.R)({ids:c,type:o.b.APPROVE});case 7:if(!(s=e.sent)||s.code!==o.b.MSG_SUCCESS){e.next=14;break}return!1||(t(Object(b.v)(!1)),d.b.success({title:"Successful",message:"The vouchers have been approved successfully"}),!0),e.next=13,new Promise((function(e){return setTimeout(e,2e3)}));case 13:p.a.push("/admin/voucher-program-approval");case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.log("approve vouchers error",e.t0);case 19:return e.prev=19,t(Object(b.v)(!1)),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[0,16,19,22]])})));return function(t,r){return e.apply(this,arguments)}}()},x=function(){return function(){var e=Object(c.a)(a.a.mark((function e(t,r){var n,c,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=r().voucher.selectedVouchers,c=u.a.flatMap(n,"vouchers").map((function(e){return e.id})),t(Object(b.v)(!0)),!c.length){e.next=14;break}return e.next=7,Object(l.R)({ids:c,type:o.b.REJECT});case 7:if(!(s=e.sent)||s.code!==o.b.MSG_SUCCESS){e.next=14;break}return!1||(d.b.success({title:"Successful",message:"The vouchers have been rejected successfully"}),!0),e.next=13,new Promise((function(e){return setTimeout(e,2e3)}));case 13:p.a.push("/admin/voucher-program-approval");case 14:return e.prev=14,t(Object(b.v)(!1)),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,,14,17]])})));return function(t,r){return e.apply(this,arguments)}}()},_=function(){return function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t(j("")),t(v([])),t(O(!0));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},Nng6:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/shop/voucher-coupon/components/TableUpcomingMyShop",function(){return r("6t8x")}])}},[["Nng6",0,1,9,13,16,18,19,21,20,17,22,2,3,4,6,5,7,8,10,12,11,14,15,23]]]);